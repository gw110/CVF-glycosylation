## Creat a databased called 'raw_data.db'

.open raw_data.db

## Import the glycan data 'Glycan_data.csv', clinical data 'clinical_data.csv'

DROP TABLE IF EXISTS glycan_data;
DROP TABLE IF EXISTS clinical_data;

.mode csv
.import CVF_data.csv glycan_data
.import clinical_data.csv clinical_data


## Generate the data for Supplementary_Figure_7_A

.mode csv
.headers on
.output Supplementary_Figure_7_A_data.csv

SELECT *

FROM  (
	 
	 	
	 (SELECT [Sample.name], SUM(Intensity) total_Intensity
	  FROM glycan_data
	  GROUP BY [Sample.name]) total
	  
	  LEFT JOIN 
	 
	 (SELECT [Sample.name], SUM(Intensity) NeuAc_Intensity
	  FROM glycan_data
	  WHERE [NeuAc.count]>0
	  GROUP BY [Sample.name]) NeuAc_total
	
	 		
	  ON total.[Sample.name] = NeuAc_total.[Sample.name]

	  
	  INNER JOIN
		
	  clinical_data
			
	  ON total.[Sample.name]=clinical_data.[VMET.2.number]
	 );
		
	
	
## Generate the data for Supplementary_Figure_7_B

.mode csv
.headers on
.output Supplementary_Figure_7_B_data.csv

SELECT *

FROM  (	 	
	 (SELECT [Sample.name], SUM(Intensity) total_Intensity
	  FROM glycan_data
	  WHERE [dHex.count]>1
	  GROUP BY [Sample.name]) total
	  
	  LEFT JOIN 
	 
	 (SELECT [Sample.name], SUM(Intensity) NeuAc_Intensity
	  FROM glycan_data
	  WHERE [NeuAc.count]>0 AND [dHex.count]>1
	  GROUP BY [Sample.name]) NeuAc_total
	
	 		
	  ON total.[Sample.name] = NeuAc_total.[Sample.name]

	  
	  INNER JOIN
		
	  clinical_data
			
	  ON total.[Sample.name]=clinical_data.[VMET.2.number]
	 );	
	 


## Generate the data for Supplementary_Figure_7_C

.mode csv
.headers on
.output Supplementary_Figure_7_C_data.csv

SELECT *

FROM  (
	 
	 	
	 (SELECT [Sample.name], SUM(Intensity) total_Intensity
	  FROM glycan_data
	  WHERE [dHex.count]>3
	  GROUP BY [Sample.name]) total
	  
	  LEFT JOIN 
	 
	 (SELECT [Sample.name], SUM(Intensity) NeuAc_Intensity
	  FROM glycan_data
	  WHERE [NeuAc.count]>0 AND [dHex.count]>3
	  GROUP BY [Sample.name]) NeuAc_total
	
	 		
	  ON total.[Sample.name] = NeuAc_total.[Sample.name]

	  
	  INNER JOIN
		
	  clinical_data
			
	  ON total.[Sample.name]=clinical_data.[VMET.2.number]
	 );	


